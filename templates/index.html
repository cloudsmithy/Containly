<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>Containly å®¹å™¨é¢æ¿</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<div id="toast-container" style="
  position: fixed;
  top: 10px;
  right: 10px;
  z-index: 9999;
"></div>

<div class="top-bar">
  <h1>Containly å®¹å™¨é¢æ¿</h1>
  <label for="host-ip">å®¿ä¸»æœº IPï¼š</label>
  <input type="text" id="host-ip" placeholder="ä¾‹å¦‚ 192.168.1.100" />
  <a href="/blacklist" class="blacklist-link">é»‘åå•ç®¡ç†</a>
  <button class="dark-toggle" id="darkBtn">ğŸŒ™</button>
</div>

{% for status, containers in grouped.items() %}
<div class="section" data-status="{{ status }}">
  <h2>{{ status|capitalize }} å®¹å™¨</h2>
  <div class="grid">
    {% for c in containers %}
    <div class="card"
         data-container-id="{{ c.id }}"
         data-container-name="{{ c.name }}"
         data-protocol="http">
      <div class="card-actions">
        {% if c.status == "running" %}
        <button class="action-btn stop-btn" data-id="{{ c.id }}" title="åœæ­¢å®¹å™¨">ğŸ›‘</button>
        <button class="action-btn restart-btn" data-id="{{ c.id }}" title="é‡å¯å®¹å™¨">ğŸ”„</button>
        <button class="action-btn logs-btn" data-id="{{ c.id }}" title="æŸ¥çœ‹æ—¥å¿—">ğŸ“‹</button>
        {% elif c.status == "exited" %}
        <button class="action-btn start-btn" data-id="{{ c.id }}" title="å¯åŠ¨å®¹å™¨">â–¶ï¸</button>
        <button class="action-btn logs-btn" data-id="{{ c.id }}" title="æŸ¥çœ‹æ—¥å¿—">ğŸ“‹</button>
        {% endif %}
        <button class="action-btn protocol-btn" title="åˆ‡æ¢åè®®">ğŸ”</button>
        <button class="action-btn blacklist-btn" title="åŠ å…¥é»‘åå•">ğŸš«</button>
      </div>

      <h3>{{ c.name }}</h3>
      <div class="tag {{ 'host' if c.network == 'host' else '' }}">{{ c.network }}</div>
      
      <!-- èµ„æºä½¿ç”¨æƒ…å†µ -->
      {% if c.status == "running" %}
      <div class="resource-usage">
        <div class="resource-bar">
          <div class="resource-fill" style="width: {{ c.cpu_usage }}%"></div>
        </div>
        <div class="resource-text">CPU: {{ c.cpu_usage }}%</div>
        
        <div class="resource-bar">
          <div class="resource-fill" style="width: {{ c.memory_usage }}%"></div>
        </div>
        <div class="resource-text">å†…å­˜: {{ c.memory_usage }}%</div>
      </div>
      {% endif %}
      
      <div class="port-list">
        {% for p in c.ports %}
        <div class="port-item" data-host="{{ p.host_port }}" data-container="{{ p.container_port }}">
          Host: <span class="copyable host-port">{{ p.host_port }}</span> |
          Container: <span class="copyable container-port">{{ p.container_port }}</span> â€“
          <a href="#" class="port-link" target="_blank">è·³è½¬</a>
          <span class="status-indicator" title="æ£€æµ‹ä¸­..."></span>
        </div>
        {% endfor %}
        
        {% if not c.ports %}
        <div class="port-item">æ— ç«¯å£æ˜ å°„</div>
        {% endif %}
      </div>
    </div>
    {% endfor %}
    
    {% if not containers %}
    <div class="empty-state">æ²¡æœ‰{{ status }}çŠ¶æ€çš„å®¹å™¨</div>
    {% endif %}
  </div>
</div>
{% endfor %}

<!-- æ—¥å¿—æŸ¥çœ‹å™¨ -->
<div class="log-viewer">
  <div class="log-header">
    <h2>å®¹å™¨æ—¥å¿—</h2>
    <button class="log-close">&times;</button>
  </div>
  <div class="log-content"></div>
</div>

<script src="/static/js/main.js"></script>
</body>
</html>
